<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>

        <template id="report_cenova_ponuka_pdf_document_oddiel">
            <t t-call="report.internal_layout">
                <t t-set="o" t-value="oddiel" />
                <div class="page">
                    <h2>sub page Cenova ponuka</h2>
                    <h1>sub page IDecko</h1>
                </div>
            </t>
        </template>

        <template id="report_cenova_ponuka_pdf_document">
             <th t-call="report.internal_layout">
                <div class="page">
                    <t t-set="d" t-value="doc" />
                    <div class="hlavicka">
                        <div class="row1">
                            <p t-if="d.name">Názov: <h3><span t-field="d.name"/></h3></p>
                        </div>
                        <div class="row2">
                            <td t-if="d.financny_kod">Finančný kód: <strong><span t-field="d.financny_kod"/></strong></td>
                            <td t-if="d.skratka">Skratka: <strong><span t-field="d.skratka"/></strong></td>
                            <td t-if="d.cislo">Číslo projektu PSID: <strong><span t-field="d.cislo"/></strong></td>
                        </div>
                        <div class="row3">
                            <td t-if="d.pc_id.name">PC: <strong><span t-field="d.pc_id.name"/></strong></td>
                            <td t-if="d.pm_id.name">PM: <strong><span t-field="d.pm_id.name"/></strong></td>
                        </div>
                        <div class="row4">
                            <td t-if="d.datum_zaciatok">Dátum zahájenia: <strong><span t-field="d.datum_zaciatok"/></strong></td>
                            <td t-if="d.datum_koniec">Dátum ukončenia: <strong><span t-field="d.datum_koniec"/></strong></td>
                        </div>
                        <div class="row5">
                            <p t-if="d.poznamka">Poznámka: <strong><span t-field="d.poznamka"/></strong></p>
                        </div>
                        <div class="row6">
                            <p t-if="d.celkova_cena">Celková cena: <h4><span t-field="d.celkova_cena"/></h4></p>
                        </div>
                    </div>
                    <t t-set="rows" t-value="d._get_oddiel(d.id)"/>
                    <t t-set="oddiels" t-value="d._get_oddiel(d.id)"/>
                    <section>
                        <h3>MONTÁŽ</h3>
                        <t t-foreach="oddiels[0]" t-as="oddiel">
                            <tr>
                                <td style="font-size:150%;"><span t-esc="oddiel['oddiel']"/></td>
                                <td><span t-esc="d._get_price_oddiel(d.id, oddiel['id'], 3, 0)[0]" t-esc-options='{"widget": "monetary", "display_currency": "d.currency_id"}'/></td>
                            </tr>
                            <div>
                                <div>
                                    <t t-set="rowstyp" t-value="d._get_rows_oddiel_typ(d.id,oddiel['id'])"/>
                                    <t t-set="index" t-value="0" />
                                    <tr t-foreach="rowstyp[0]" t-as="rowtyp">
                                        <t t-set="index" t-value="index+1" />
                                        <table>
                                            <t t-if="index==1">
                                                <h5>Typové položky</h5>
                                                <thead>
                                                    <tr>
                                                        <th>Oddiel</th>
                                                        <th>Položka</th>
                                                        <th>Mj</th>
                                                        <th>J. cena</th>
                                                        <th>Cena celkom</th>
                                                    </tr>
                                                </thead>
                                            </t>
                                            <tbody>
                                                <td><span t-esc="rowtyp['oddiel']"/></td>
                                                <td><span t-esc="rowtyp['polozka']"/></td>
                                                <td><span t-esc="rowtyp['mj']"/></td>
                                                <td><span t-esc="rowtyp['cena_jednotkova']"/></td>
                                                <td><span t-esc="rowtyp['cena_celkom']"/></td>
                                            </tbody>
                                        </table>
                                    </tr>
                                    <tr t-if="index>0">
                                        <td><strong>Položky celkom</strong></td>
                                        <td><span t-esc="d._get_price_oddiel(d.id, oddiel['id'], 0, 0)[0]" t-esc-options='{"widget": "monetary", "display_currency": "d.currency_id"}'/></td>
                                    </tr>
                                </div>
                                <div>
                                    <t t-set="rowsatyp" t-value="d._get_rows_oddiel_atyp(d.id,oddiel['id'])"/>
                                    <t t-set="indexatyp" t-value="0" />
                                    <tr t-foreach="rowsatyp[0]" t-as="rowatyp">
                                        <t t-set="indexatyp" t-value="indexatyp+1" />
                                        <table>
                                            <t t-if="indexatyp==1">
                                                <h5>Atypové položky</h5>
                                                <thead>
                                                    <th>Oddiel</th>
                                                    <th>Položka</th>
                                                    <th>Cena celkom</th>
                                                </thead>
                                            </t>
                                            <tbody>
                                                <td><span t-esc="rowatyp['oddiel']"/></td>
                                                <td><span t-esc="rowatyp['polozka']"/></td>
                                                <td><span t-esc="rowatyp['cena_celkom']"/></td>
                                            </tbody>
                                        </table>
                                    </tr>
                                    <tr t-if="indexatyp>0">
                                        <td><strong>Atypové položky celkom</strong></td>
                                        <td><span t-esc="d._get_price_oddiel(d.id, oddiel['id'], 1, 0)[0]" t-esc-options='{"widget": "monetary", "display_currency": "d.currency_id"}'/></td>
                                    </tr>
                                </div>
                            </div>
                        </t>
                    </section>
                    <section>
                        <h3>BALÍČKY</h3>
                        <div>
                            <t t-set="rowsbalicek" t-value="d._get_rows_oddiel_balicek(d.id)"/>
                            <t t-set="index" t-value="0" />
                            <tr t-foreach="rowsbalicek[0]" t-as="rowbalicek">
                                <t t-set="index" t-value="index+1" />
                                <table>
                                    <t t-if="index==1">
                                        <thead>
                                            <tr>
                                                <th>Kod</th>
                                                <th>Položka</th>
                                                <th>Počet</th>
                                                <th>J. cena</th>
                                                <th>Cena celkom</th>
                                            </tr>
                                        </thead>
                                    </t>
                                    <tbody>
                                        <td><span t-esc="rowbalicek['kod']"/></td>
                                        <td><span t-esc="rowbalicek['polozka']"/></td>
                                        <td><span t-esc="rowbalicek['pocet']"/></td>
                                        <td><span t-esc="rowbalicek['cena_jednotkova']"/></td>
                                        <td><span t-esc="rowbalicek['cena_celkom']"/></td>
                                    </tbody>
                                </table>
                            </tr>
                            <tr t-if="index>0">
                                <td><strong>Balíčky celkom</strong></td>
                                <td><span t-esc="d._get_price_balicky(d.id)[0]" t-esc-options='{"widget": "monetary", "display_currency": "d.currency_id"}'/></td>
                            </tr>
                        </div>
                    </section>

                    <!--<tbody>
                        <div class="row">??????: <span t-field="user.name"/> - <span t-esc="time.strftime('%Y-%m-%d %H:%M:%S')"/>
                            <t t-set="oddiels" t-value="d._get_oddiel(d.id)"/>
                                <tr t-foreach="d._get_oddiel(d.id)" t-as="oddiel">
                                <t t-call="report.html_container">
                                    <tr>
                                        <td>
                                            <span t-esc="oddiel[0]"/>
                                        </td>
                                    </tr>
                                </t>
                                <t t-call="o2net.report_cenova_ponuka_pdf_document_oddiel"/>
                            </tr>
                        </div>
                    </tbody>-->

                </div>
            </th>
        </template>

        <template id="report_cenova_ponuka_pdf">
            <t t-call="report.html_container">
                <t t-foreach="docs" t-as="doc">

                    <!--<t t-call="o2net.layout_header" />-->
                    <!--<t t-call="o2net.report_cenova_ponuka_pdf_document" t-lang="doc.dodavatel_id.lang"/>-->
                    <!--<t t-call="o2net.layout_footer" />-->
                    <t t-call="o2net.report_cenova_ponuka_pdf_document"/>
                    <!--<t t-call="o2net.report_cenova_ponuka_pdf_document" t-lang="doc.dodavatel_id.lang"/>-->
                </t>
                 <div class="footer">
                     <div class="row">Vytlacil: <span t-field="user.name"/> - <span t-esc="time.strftime('%Y-%m-%d %H:%M:%S')"/></div>
                 </div>
            </t>
        </template>

        <!--
        <template id="report_cenova_ponuka_pdf_document">
            <t t-set="doc" t-value="doc.with_context({'lang':doc.dodavatel_id.lang})" />
                <t t-call="report.internal_layout">
                    <div class="page">
                        <h2>Cenova ponuka <span t-field="doc.name"/></h2>
                        <div>
                            <div>stav: <span t-field="doc.state"/></div>
                            <div>Celkova cena: <span t-field="doc.celkova_cena"/></div>
                        </div>
                        <p>
                            <div>Číslo: <span t-field="doc.cislo"/></div>
                            <div>Finančný kód: <span t-field="doc.financny_kod"/></div>
                            <div>Skratka: <span t-field="doc.skratka"/></div>
                            <div>Zahájenie: <span t-field="doc.datum_zaciatok"/></div>
                            <div>Ukončenie: <span t-field="doc.datum_koniec"/></div>
                        </p>
                        <p>
                            <div>??? Dodávateľ: ???<span t-field="doc.dodavatel_id.name"/> - Cenník: <span t-field="doc.cennik_id.name"/></div>
                            <div>PC(projektový koordinátor): <span t-field="doc.pc_id.name"/></div>
                            <div>PM(projektový manažér): <span t-field="doc.pm_id.name"/></div>
                            <div>Manager: <span t-field="doc.manager_ids"/></div>
                        </p>
                        <p>
                            <div>Poznámka: <span t-field="doc.poznamka"/></div>
                        </p>
                        <table class="table table-condensed0">
                            <tbody>
                                <t t-set="oddiel_group_ot" t-value="[]"/>
                            </tbody>
                        </table>

                        <t t-set="rows" t-value="doc._get_rows(doc.id)"/>
                        <table class="table table-condensed0">
                            <t t-set="oddiel_typ_group" t-value="[]"/>
                            <t t-foreach="rows[0]" t-as="row">
                                <t t-set="oddiel_typ_group" t-value="oddiel_typ_group+[row['oddieltyp']]"/>
                            </t>
                            <t t-foreach="set(oddiel_typ_group)" t-as="oddieltyp">
                                <div><strong t-esc="oddieltyp"/>
                                </div>
                                <t t-foreach="rows[0]" t-as="row">
                                    <t t-if="oddieltyp==row['oddieltyp']">
                                        <div><span t-esc="row['oddiel']"/></div>
                                    </t>
                                </t>
                            </t>
                        </table>
                        <table class="table table-condensed1">
                            <t t-set="oddiel_group" t-value="[]"/>
                            <t t-foreach="rows[0]" t-as="row">
                                <t t-set="oddiel_group" t-value="oddiel_group+[row['oddiel']]"/>
                            </t>
                            <t t-foreach="set(oddiel_group)" t-as="oddielg">
                                <div><strong t-esc="oddielg"/>
                                </div>
                                <t t-foreach="rows[0]" t-as="row">
                                    <t t-if="oddielg==row['oddiel']">
                                        <div><span t-esc="row['oddiel']"/></div>
                                    </t>
                                </t>
                            </t>
                        </table>

                    </div>

                    <div class="footer">
                        <div class="row">Vytlacil: <span t-field="user.name"/> - <span t-esc="time.strftime('%Y-%m-%d %H:%M:%S')"/></div>
                    </div>
                </t>
        </template>
        -->
                        <!--<table class="table table-condensed">
                            <tbody>
                                <group></group>
                                <t t-set="oddiel_group" t-value="[]"/>
                                <t t-set="rows" t-value="doc._get_rows(doc.id)"/>
                                <t t-foreach="rows[0]" t-as="row">
                                    <t t-set="oddiel_group" t-value="oddiel_group+[row['oddiel']]"/>
                                </t>
                                <t t-foreach="set(oddiel_group)" t-as="oddielg">
                                    <div><strong t-esc="oddielg"/>
                                        <tr>
                                            <th><strong>Oddiel</strong></th>
                                            <th><strong>Položka</strong></th>
                                            <th><strong>Merná jednotka</strong></th>
                                            <th class="text-right"><strong>Počet</strong></th>
                                            <th class="text-right"><strong>Jednotková cena</strong></th>
                                            <th class="text-right"><strong>Cena celkom</strong></th>
                                        </tr>
                                    </div>
                                    <t t-foreach="rows[0]" t-as="row">
                                        <t t-if="oddielg==row['oddiel']">
                                            <div><span t-esc="row['oddiel']"/></div>
                                            <div><span t-esc="row['polozka']"/></div>
                                        </t>
                                    </t>
                                </t>

                                        <tr t-foreach="rows[0]" t-as="row">
                                            <td>
                                                <span t-esc="row['oddiel']"/>
                                            </td>
                                            <td>
                                                <span t-esc="row['polozka']"/>
                                            </td>
                                            <td class="text-center">
                                                <span t-esc="row['mj']"/>
                                            </td>
                                            <td class="text-right">
                                                <span t-esc="row['pocet']"/>
                                            </td>
                                            <td class="text-right">
                                                <span t-esc="row['cena_jednotkova']"/>
                                            </td>
                                            <td class="text-right">
                                                <span t-esc="row['cena_celkom']"/>
                                            </td>
                                        </tr>
                            </tbody>
                        </table>-->


        <!-- copied from report/views/layouts.xml -->
        <!--
        <template id="layout_header">
            <div class="header">
                <div class="row">
                    <div class="col-xs-3">
                        <img t-if="company.logo" t-att-src="'data:image/png;base64,%s' % company.logo" style="max-height: 45px;"/>
                    </div>
                    <div class="col-xs-9 text-right" style="margin-top:20px;" t-field="company.rml_header1"/>
                </div>
                <div class="row zero_min_height">
                    <div class="col-xs-12">
                        <div style="border-bottom: 1px solid black;"></div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-3" name="company_address">
                        <div t-field="company.partner_id"
                            t-field-options='{"widget": "contact", "fields": ["address", "name"], "no_marker": true}'
                            style="border-bottom: 1px solid black;"/>
                    </div>
                </div>
            </div>

        </template>
        -->


    </data>
</openerp>